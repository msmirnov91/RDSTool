# DRSTool
Консольное приложение, транслитизирующее текст из входного файла в случае, если он написан русскими буквами. Используется в радиовещании для
передачи с помощью стандарта RDS имени исполнителя и названия текущей песни. На выходе создает файл с транслитизированным текстом, мета-файл с текстом из входного файла без изменений и файл, полностью повторяющий исходный, но в другой кодировке. Предусмотрена также функция загрузки одного из файлов на сервер по FTP. Файл с транслитизированным текстом и мета-файл создаются в формате "Исполнитель разделитель название". Возможно также запретить программе выполняться в определенные часы каждого дня недели.


## Требования
 - Входной файл должен быть в формате XML, необходимый текст должен быть в тэгах \<ARTIST> и \<NAME>
 - Приложение работает с первыми тэгами, которые встретит в файле


## Настройки
Приложение хранит свои настройки в файле settings.ini. В случае его отсутствия либо отутствия в нем нужных настроек
будут применены настройки по умолчанию: создание файлов и загрузка их на сервер разрешены всегда, хост, логин и пароль фтп, а также префикс исключения - пустые строки. Значения по умолчанию для всех параметров из группы MainSettings соответствуют значениям в примере. Пример файла с настройками приведен ниже.

>[MainSettings]  
inputFile=cur_playing_1.xml  
rdsFile=rds.txt  
metaFile=meta.txt  
recodedXml=cur_playing_decoded.xml  
recodedXmlEncoding=Windows-1251  
rdsSeparator= -    
metaSeparator= -   

>[FTPSettings]  
;doUpload=false  
fileToUpload=cur_playing_decoded.xml  
url=ftp://some.domain.ru 
login=login  
password=pass  

>[TimeSettings]  
mon=1  
tue=2  
wed=3  
thu=4  
fri=5  
sat=6  
sun=7  

>[ExceptionPrefix]  
prefix=ACHTUNG!  

>[Replacement0]  
replaceWhat=DDT  
replaceWithWhat=U.Shevchuk  

В секции MainSettings указываются имена файлов, с которыми работает программа, разделители для выходных файлов а также кодировка, в которой будет создан перекодированный XML. Список возможных вариантов этого параметра приведен [здесь](http://doc.qt.io/qt-5/qtextcodec.html#details).  
В секции FTPSettings указываются параметры доступа к серверу, на который будет выгружен файл. За то, какой именно файл будет выгружен, отвечает параметр fileToUpload. Функцию выгрузки файла можно отменить, раскомментировав строку doUpload=false.  
В секции TimeSettings указаны дни недели и соответствующие часы, по которым в эти дни создание выходных файлов запрещено.   
В случае если часов несколько, они указываются через пробел.  
Настройка prefix содержит строку, которая выводится перед каждым сообщением об ошибке (например, в данном случае сообщение
о невозможности открыть входной файл будет выглядеть так: "ACHTUNG! Can't open input XML!"). По умолчанию - пустая строка.  
  ___В случае если в логине, пароле и т.д. встречается символ '\\', его необходимо писать два раза, т.е. вместо "my\\login" писать "my\\\\login"___  
Секции Replacement позволяют сделать замену некоторых символов в считанных из входного файла строках. Секций может быть неограниченное количество. Их номера должны начинаться с нуля и следовать по порядку. Возможна замена русских символов. Согласно примеру, во всех считанных из входного файла строках (имени исполнителя и названии песни) все вхождения строки "DDT" будут заменены на "U.Shevchuk". 


## Логи ошибок
Ошибки открытия входного файла, неправильной структуры XML-документа и невозможности создать выходные файлы логгируются в 
файл errors.log, который находится в директории программы. Формат записи следующий: "ДАТА ВРЕМЯ ERROR [default] prefix сообщение"

